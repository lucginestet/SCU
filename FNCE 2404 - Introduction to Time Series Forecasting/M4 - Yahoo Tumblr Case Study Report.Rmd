---
title: 'M4: Yahoo Tumblr Case Study Report'
author: "Luc Ginestet"
date: "4/13/2021"
output: html_document
---

```{r setup, include=FALSE}
library(fpp2)
library(apsrtable)
library(lubridate)
library(pander)
```

```{r exhibits, echo=FALSE}
exhibit1_data <- matrix(c(25349036,19020118,69837544,1015761920,0,
                          28001532,21096692,75802128,1061456128,0,
                          30279004,22496896,86279520,1265348480,0,
                          33237588,24571154,96291688,1470884480,0,
                          37326484,27744680,105718912,1664430976,0,
                          40863800,30076088,119718336,1854833792,0,
                          43169608,31175164,134986816,2291991808,0,
                          47188576,33880472,150272848,2823663104,0,
                          49037412,34924704,160452736,3311109376,0,
                          57963812,41301888,188368416,4086928384,0,
                          66005040,47274360,209648432,4557380608,0,
                          71810592,51564920,225196544,4985839616,0,
                          81144880,58317276,252242864,6072128512,0,
                          86220960,61791824,269872768,6633003520,0,
                          92864688,65738312,302446528,8395395584,0,
                          96766816,68923552,307647744,11171966976,0,
                          102736800,72821928,331085056,11710914560,0,
                          103348104,73609824,327252672,11661173760,0,
                          108685128,78024504,333555968,12117823488,0,
                          115729016,82445192,363336992,13037852672,8937000,
                          128263416,92087096,388764448,14020779008,11940532,
                          141254192,102296752,411443200,15470049280,13382846,
                          150845248,109841544,427660064,15600432128,14279108,
                          144538016,104106168,428548096,14919027712,14945914,
                          159860096,115758448,459963648,16286919680,17206288,
                          157223536,113899360,452455072,14786557952,16491142,
                          150399104,108543472,440980480,15352449024,15773518,
                          156465760,112769072,459181536,15903661056,19840210,
                          166808528,120256160,485624512,14668607488,22140054,
                          172062880,124390192,493932928,13998592000,26643136,
                          184667216,134480224,510799456,15234562048,29179220,
                          201892656,147525568,543773824,16674483200,31805100,
                          197982400,145602464,521876704,16516643840,35192792,
                          200280768,146146144,543114240,16718012416,39517752,
                          188579824,140544144,475777344,14677705728,38900468,
                          184908016,136447584,485839744,13837069312,34973080,
                          191476128,138832112,536019584,12958793728,38361680,
                          186668560,136477904,507532928,13379749888,36820980
                          ),ncol=5,byrow=TRUE)
colnames(exhibit1_data) <- c('Uniques','People','Visits','Page Views','Mobile Web')
exhibit1 <- ts(exhibit1_data, frequency=12, start=c(2010,4,1))
autoplot(exhibit1[,'People'])+xlab('Month')+ylab('People')+ggtitle('Tumblr’s Worldwide Monthly Direct Audience')
```

## Introduction
Identify the business problem.

## Background
Select relevant facts and most important issues in the case.

## Data Analysis


## Proposed Solutions and Recommendations
* Since April 2010, what has been the average monthly growth in the number of people worldwide accessing Tumblr's site? If Tumblr experienced this rate of growth for the next 10 years, how many people worldwide would be accessing Tumblr's site in December 2022?
</br>
Tumblr's monthly growth rates:
</br>
```{r question 1a, echo=FALSE}
growth_rate <- function(x) (x/lag(x,k=-1)-1)
tumblr_gr <- growth_rate(exhibit1[,'People'])
tumblr_avg_gr <- mean(tumblr_gr)

tumblr_gr
```
</br>
The average monthly growth rate for people worldwide accessing Tumblr since April 2010 was:
</br>
```{r question 1 avg, echo=FALSE}
tumblr_avg_gr
```
</br>
Using this constant growth rate, by December 2022 Tumblr would reach 73,486,723,098 people around the world which is greater than the entire human population meaning that this growth rate is unsustainable.
</br>
```{r question 1b, echo=FALSE}
136477904*((1+tumblr_avg_gr)^(115))
```
</br>

* How does the average monthly growth rate over the past all months compare to the average monthly growth rate over the past 12 months?
</br>
Tumblr's monthly growth rate for the past 12 months:
</br>
```{r question 2, echo=FALSE}
exhibit1_12m = window(exhibit1,start=c(2012,5))
tumblr_12m_gr <- growth_rate(exhibit1_12m[,'People'])
tumblr_12m_avg_gr <- mean(tumblr_12m_gr)

tumblr_12m_gr
```
</br>
The average growth rate for people worldwide accessing Tumblr over the past 12 months was:
</br>
```{r question 2 display, echo=FALSE}
tumblr_12m_avg_gr
```
</br>
This is much lower than the 5.62% growth rate since April 2010 which further proves that this growth rate was unsustainable and can only have expected to occur in the infancy of the company. Once any company reaches a certain level of maturity, the growth rate for new users will have invariably be reduced significantly.
</br>

* Use the exponential smoothing models we have learned in class and try to fit the following models again the data:
  + Holt's Linear Trend Model
  + Holt's Damped Trend Model
  + Multiplicative Error Damped Exponential Trend Model
  + Which of the models best fits the data?
```{r question 3, echo=FALSE}
fit_holt <- fitted(holt(exhibit1[,'People'],PI=FALSE))
fit_holt_damp <- fitted(holt(exhibit1[,'People'],damped=TRUE,PI=FALSE))
fit_man_damp <- fitted(ets(exhibit1[,'People'], model="MAN", damped=TRUE))

autoplot(exhibit1[,'People'], series="Data") +
  autolayer(fit_holt, series="Holt") +
  autolayer(fit_holt_damp, series="Holt Damped") +
  autolayer(fit_man_damp, series="MAN Damped") +
  xlab("Month") + ylab("People") +
  ggtitle("Fitted Worldwide Tumblr Audience")


exhibit1_pre12m <- window(exhibit1,start=c(2010,4),end=c(2012,4))

holt <- holt(exhibit1_pre12m[,'People'],PI=FALSE,h=13)
holt_damp <- holt(exhibit1_pre12m[,'People'],damped=TRUE,PI=FALSE,h=13)
man_damp <- forecast(ets(exhibit1_pre12m[,'People'], model="MAN",damped=TRUE),h=13)

accuracy_data <- matrix(c(accuracy(holt,exhibit1_12m[,'People']),
                          accuracy(holt_damp,exhibit1_12m[,'People']),
                          accuracy(man_damp,exhibit1_12m[,'People'])),
                          ncol=16,byrow=TRUE)
colnames(accuracy_data) <- c('Training ME','Test ME','Training RMSE','Test RMSE','Training MAE','Test MAE','Training MPE','Test MPE',
                             'Training MAPE','Test MAPE','Training MASE','Test MASE','Training ACF1','Test ACF1','Training Theils U','Test Theils U')
rownames(accuracy_data) <- c('Holt','Holt Damped','MAN Damped')
accuracy_table <- data.frame(subset(accuracy_data,select=c('Test RMSE','Test MAE','Test MAPE','Test MASE')))

accuracy_table
```

* What are your forecasts of people worldwide accessing Tumblr’s site for the next 115 months from June 2013 to December 2022?
```{r question 4, echo=FALSE}
data.frame(holt(exhibit1[,'People'],PI=FALSE,h=115))

autoplot(holt(exhibit1[,'People'],PI=FALSE,h=115))+xlab('Month')+ylab('People')+ggtitle('Tumblr’s Worldwide Monthly Direct Audience Forecast')
```

* How would you revise the valuation of Tumblr in case Exhibit 5 based on your forecasts? (Case Exhibit 5’s valuation model is in the provided spreadsheet).
Since my best forecast for the number of people worldwide that use Tumblr is around 547 million, I would lower Yahoo's valuation since it forecasts 712 million users at the end of 2022.

* Is there anything else you want to change for Exhibit 5? If you were on Yahoo’s board, would you have voted to approve the acquisition of Tumblr for $1.1 billion?
