---
title: 'M3: Lac Leman Festival Case Study Report'
author: 'Luc Ginestet'
date: '4/6/2021'
output:
  html_document:
    df_print: kable
---

```{r setup, include=FALSE}
library(fpp2)
library(apsrtable)
```

## Introduction
The director of a festival must decide whether or not they should make nonrefundable deposits on services in order to make DVDs of the previous night's show to sell to festival goers the next day. This is the first time they will sell this kind of DVD at the festival so they do not know what demand will look like. If they do go forward with the deposits, they must then decide how many DVDs to produce since they have to be made ahead of time. The main business problem here is to forecast what demand will look like for the DVDs given attendance numbers, weather, and survey results that shows what percentage of attendees would be interested in buying the DVD.

## Background
* Friday/Saturday admission price: CHF30
* Video crew nonrefundable fee: CHF11,740
* Editing fee: CHF3,000
* Production company setup fee: CHF1,250
* DVD cost per unit (up to 5,300): CHF0.86
* DVD extra cost per unit (after 5,300): CHF0.20
* DVD royalty fee per unit: CHF1.02
* DVD price per unit: CHF18
* Mean probability of an individual attendee's choice to buy the DVD: 0.1892
* Standard deviation of an individual's choice: 0.3917
* Friday attendance: 18,394
* Chance of rain on Saturday: 80%

## Data Analysis
```{r exhibits, echo=FALSE}
exhibit1a <- ts(c(6510,43580,39360,28590,33560,13710,15410,24190,14240,19310,17470,34250,33910,20990,17000),start=1,frequency=1)

exhibit1b_data <- matrix(c(1,3960,1,6510,
                           1,26920,0,43580,
                           0,25430,0,39360,
                           1,17750,0,28590,
                           0,24910,0,33560,
                           1,10210,1,13710,
                           1,8910,0,15410,
                           0,27080,1,24190,
                           0,14140,1,14240,
                           0,12740,0,19310,
                           0,11110,0,17470,
                           0,18750,0,34250,
                           0,20390,0,33910,
                           0,13440,0,20990,
                           0,11570,0,17000),ncol=4,byrow=TRUE)
colnames(exhibit1b_data) <- c('Friday_Rain','Friday_Attendance','Saturday_Rain','Saturday_Attendance')
exhibit1b <- ts(exhibit1b_data)
autoplot(exhibit1a) + xlab('Year')+ylab('Attendees')+ggtitle('Historic Saturday Attendance')
```
</br>
Choose best simple forecasting model
</br>
```{r simple, echo=FALSE}
exhibit1a_window <- window(exhibit1a,start=1,end=12)
exhibit1a_test <- window(exhibit1a,start=13)

mean_window <- meanf(exhibit1a_window,h=3)
naive_window <- naive(exhibit1a_window,h=3)
drift_window <- rwf(exhibit1a_window,drift=TRUE,h=3)

accuracy_data <- matrix(c(paste(accuracy(mean_window,exhibit1a_test)),
                                accuracy(naive_window,exhibit1a_test),
                                accuracy(drift_window,exhibit1a_test)),ncol=16,byrow=TRUE)
colnames(accuracy_data) <- c('Training ME','Test ME','Training RMSE','Test RMSE','Training MAE','Test MAE','Training MPE','Test MPE',
                             'Training MAPE','Test MAPE','Training MASE','Test MASE','Training ACF1','Test ACF1','Training Theils U','Test Theils U')
rownames(accuracy_data) <- c('Mean','Naive','Drift')

accuracy_table <- data.frame(subset(accuracy_data,select=c('Test RMSE','Test MAE','Test MAPE','Test MASE')))
```
```{r cols.print=4, rows.print=3, echo=FALSE}
autoplot(exhibit1a) +
  autolayer(mean_window,series='Mean',PI=FALSE) +
  autolayer(naive_window,series='Naïve',PI=FALSE) +
  autolayer(drift_window,series='Drift',PI=FALSE) +
  xlab('Year') + ylab('Attendees') +
  ggtitle('Forecasts for Saturday Attendance') +
  guides(colour=guide_legend(title='Forecast'))

accuracy_table
```
</br>
Looking at the graph and the accuracy results, the mean method is the best simple forecasting model for this exercise. The mean model has the lowest RMSE value and is the most logical model to pick since there are big variances in attendance from year to year which rules out the use of the naïve model.
</br>
```{r residuals, echo=FALSE}
checkresiduals(meanf(exhibit1a))
```
</br>
The plots of the residuals of the mean model fluctuate around zero and the Box-Ljung test here proves that there is no autocorrelation in the residuals of the model.
</br>
Next, create regression model using Friday attendance and weather inputs:
</br>
```{r regression, echo=FALSE}
reg <- tslm(Saturday_Attendance ~ Friday_Attendance + Friday_Rain + Saturday_Rain,data=exhibit1b)
summary(reg)


autoplot(exhibit1b[,'Saturday_Attendance'], series="Data") +
  autolayer(fitted(reg), series="Fitted") +
  xlab("Year") + ylab("Attendees") +
  ggtitle("Fitted Regression Forecast for Saturday Attendance") +
  guides(colour=guide_legend(title=" "))
```

## Proposed Solutions and Recommendations

* Ignoring the uncertainty, assume that Saturday attendance is 24,139, that 18.92% of Saturday attendees will buy the DVD, and that 4,500 DVDs are produced. How much profit will be made on the DVD project if this scenario occurs? Make a recommendation about whether Monte should have the check delivered today to the video crew for their fees.
```{r question 1, echo=TRUE}
revenue <- 4500*18
cost <- 11740+3000+1250+(4500*0.86)+(4500*1.02)
```
```{r question 1 display, echo=FALSE}
paste('Profit = $',revenue-cost)
```
</br>
Since profit is positive in this scenario, Monte should deliver the check today.
</br>

* Provide a complete forecast for attendance at Saturday night's performance using case Exhibit 1 only.
```{r cols.print=6, rows.print=2, echo=FALSE}
data.frame(meanf(exhibit1a,h=1))
```
</br>
Using the mean method, we forecast 24,139 attendees on Saturday night with a 95% high of 48,101 and a 95% low of 176 attendees.
</br>

* Fyno has stated (case Exhibit 2) that he estimates the mean proportion of attendees who will buy the DVD to be 0.1892. He also believes that there is uncertainty in this number which is based on a sample of 37 individuals. If on individual's outcome has a standard deviation of 0.3917, what is the standard deviation of the average proportion of 37 people? Use this standard deviation along with the mean of 0.1892 in your analysis of later questions.
```{r question 3, echo=TRUE}
sqrt(0.3917/37)
```
</br>

* The weather forecast seemed important to Fyno, along with the number of people in attendance at Friday's concert. Make your best use of that information to provide an updated complete forecast of attendance at Saturday's concert.
</br>
Since we have multiple data points that might help us predict Saturday's attendance, I will utilize a regression model to take everything into account.
</br>
```{r question 4 display, echo=FALSE}
rain <- data.frame('Friday_Attendance'=c(18394),'Friday_Rain'=c(0),'Saturday_Rain'=c(1))
no_rain <- data.frame('Friday_Attendance'=c(18394),'Friday_Rain'=c(0),'Saturday_Rain'=c(0))

forecast_rain <- forecast(reg,newdata=rain)
forecast_no_rain <- forecast(reg,newdata=no_rain)
```
</br>
Forecast if it rains on Saturday:
</br>
```{r question 4 rain display, echo=FALSE}
forecast_rain
```
</br>
Forecast if it does not rain on Saturday:
</br>
```{r question 4 no rain, echo=FALSE}
forecast_no_rain
```
</br>
Using the Friday attendance number and weather as well as assuming there is an 80% chance of rain on Saturday, the weighted average of Saturday attendance is:
</br>
```{r question 4 rain average, echo=FALSE}
rain_data = data.frame(forecast_rain)
no_rain_data = data.frame(forecast_no_rain)

round((.8*rain_data$Point.Forecast)+(.2*no_rain_data$Point.Forecast))

autoplot(exhibit1b[,'Saturday_Attendance'])+
  autolayer(forecast_no_rain,series='No Rain')+
  autolayer(forecast_rain,series='Rain')+
  xlab("Year") + ylab("Attendees") +
  ggtitle("High/Low Regression Forecast for Saturday Attendance") +
  guides(colour=guide_legend(title="Forecast"))

```
</br>

* If 4,500 DVDs are produced on Saturday for the concert later Saturday evening, what is the risk profile (distribution) of profit (including all costs related to the DVD project)?
```{r question 5, echo=FALSE, warning=FALSE}
demand <- 20453*rnorm(n=100,mean=0.1892,sd=0.1028907)
revenue <- if (demand<=4500) {demand*18} else {4500*18}
cost <- 11740+3000+1250+(4500*0.86)+(4500*1.02)
profit <- revenue-cost

hist(profit)
```
</br>
The risk profile for producing 4,500 DVDs is promising and shows that even though there is a slight chance of losing money in this venture, the festival is much more likely to make money by selling DVDs.
</br>

* Please make a recommendation for how many DVDs to order from the production company.
```{r question 6, echo=FALSE}
hist(demand)
```
</br>
Plotting the histogram of expected demand given a forecast of 20,453 attendees on Saturday, the most likely amount of demand for DVDs is around 3,000-5,000. Since there is an added cost of producing more than 5,300 DVDs, I would strongly not recommend going over that limit but any amount up to that number is feasible.
</br>

* In what ways can Carla Monte add value and reduce risk in the DVD project? Use insights you can glean both from your model and creative managerial thinking to produce ideas. Provide a rough rank order of the potential gains these ideas may provide.
1. Purchase and setup rain coverings for the most frequented areas of the festival to reduce the impact rain has on festival attendance. The regression model shows that rain causes a decrease of around 8.5k people so reducing the number of people that do not show up due to rain is a big opportunity. Logically, if attendees know that the festival has adequate protection from the rain, they will be less likely to stay at home instead of coming to the festival on a rainy day.
2. Create pre-sales for the next year's DVDs ahead of time to get an idea of what demand looks like every year. This will reduce the risk of losing money on the deposits and setup fees since we will already know how demand is shaping up.
3. Speak with the production companies involved in the DVD making process to try and come up with a revenue sharing deal in order to reduce the amount of fixed setup costs involved in the venture. If each company is responsible for their own setup costs, this will reduce the sunk costs to make DVDs for the festival. This lowers overall risk for the venture while still ensuring that the festival can benefit, albeit to a lesser degree, from DVD sales.